# Hardware

| Device | Details |
| --- | --- |
| Processor | i9-10850k |
| Motherboard | MSI MAG z490 Tomahawk |
| Memory | 2x16GB DDR4 3200 |
| Storage | WD_BLACK 1TB SN850X NVMe |
| GPU | ASUS Radeon RX 6600 XT 8GB |
| WiFi | Fenvi FV-HB1200 |
| Bluetooth | Fenvi FV-HB1200 |
| OpenCore | 1.0.4 |
| macOS | 15.4 |

Neofetch output:
![neofetch](images/neofetch.png)

System about dialog:
![about](images/about.png)

# Working

- [x] iServices
- [x] DRM / dGPU / iGPU
- [x] Sleep/Wake
- [x] Audio
- [x] MSI Mystic Light via OpenRGB on JRAINBOW1
- [x] Intel I219-V Ethernet
- [x] Bluetooth through Fenvi FV-HB1200
- [ ] Wifi through Fenvi FV-HB1200
- [x] System updates

# Kexts

- [Lilu 1.7.0](https://github.com/acidanthera/lilu/releases)
- [VirtualSMC 1.3.5](https://github.com/acidanthera/VirtualSMC/releases)
  - SMCProcessor
  - SMCSuperIO
- [WhateverGreen 1.6.9](https://github.com/acidanthera/WhateverGreen/releases)
- [AppleALC 1.9.4](https://github.com/acidanthera/AppleALC/releases)
- [IntelMausi 1.0.8](https://github.com/acidanthera/IntelMausi/releases)
- [LucyRTL8125Ethernet 1.2.2](https://github.com/Mieze/LucyRTL8125Ethernet/releases)
- [NVMeFix 1.1.2](https://github.com/acidanthera/NVMeFix/releases)
- [RestrictEvents 1.1.5](https://github.com/acidanthera/RestrictEvents/releases)
- [USBToolBox 1.1.1](https://github.com/USBToolBox/tool/releases)
  - UTBMap - generated by USBToolBox tools

# DSDT

[DSDT](DSDT.aml) extracted by SSDTTime.

# Notes

See notes for the [Sonoma](../../Sonoma-14.1/MSI-MAG-z490-Tomahawk/) build.

The upgrade process took a while, but that was only because I didn't realize that all I had to do was change `SecureBootModel` to `Disabled` and also the SMBIOS model to `iMac19,1` to get the install completed.  Those were the only meaningful changes needed.  I did have to add three items to `config.plist` to satisfy the changes from OpenCore 0.9.5 to 1.0.4.

For updates, it will be necessary to change `SecureBootModel` and the SMBIOS model to `iMac19,1`.

- macOS 15.4 upgrade required changing `SecureBootModel` and the SMBIOS model.  Easy peasy.

### Wifi WIP - abandonded

This was started to be able to do iPhone Mirroring, but that requires a T2 chip which OpenCore or OpenCore Legacy Patcher can't work around.  Air-Drop and possibly Sidecar are not worth the costs.  Using OCLP would possibly result in not being able to install updates due to having to relax or disable SIP.  Updates are more important than a couple of WiFi oddities that I don't use.

These were next steps for WiFi enablement.
 * Need to monkey with OCLP to enable the Broadcom chip.
   * See [here](https://github.com/perez987/macOS-15-Sequoia-on-z390-with-OpenCore).
     * AMFIPass
     * IOSkyWalkFmaily
     * IO80211FamilyLegacy
   * This might need to wait a few days for 15.4 support to settle down since that was just released.

Bluetooth does work, and that will remain in place.

## BIOS Settings

- OpenCore Version: 1.0.4
- BIOS Version:  `E7C80IMS.1D0`
- BIOS Settings
  - Settings
    - Advanced
      - PCIe/PCI Sub-system Settings
        - Enable Above 4G Memory
        - Enable Re-Size BAR Support
        - Disable SR-IOV
      - Integrated Peripherals
        - Enable Intel LAN
        - Enable Realtek LAN
        - Enable HD Audio Controller
        - SATA Mode:  AHCI
      - Integrated Graphics Configuration
        - Enable IGD Multi-Monitor
        - Initiate Graphic Adapter:  `IGD`
        - Integrated Graphics Share Memory:  `64MB`
      - USB Configuration
        - Enable XHCI Hand-off
        - Enable Legacy USB Support *-- System won't boot from USB without this*
        - USB Port Control
          - All ports enabled
      - Power Management Setup
        - Disable ErP Ready
        - Disable System Power Fault Protection
        - Disable USB Standby Power at S4/S5
        - Restore after AC Power Loss: `Power off`
      - BIOS CSM/UEFI Mode:  `UEFI`
      - Disable DTM
      - Wake Up Event Setup
        - Wake Up Event By:  `BIOS`
        - Enable Resume By Onboard Intel LAN
        - Disable Resume By RTC Alarm
        - Disable Resume By PCI-E Device
        - Disable Resume By USB Device
        - Disable Resume From S3/S4/S5 by PS/2 Mouse
        - Disable Resume From S3/S4/S5 by PS/2 Keyboard
    - Boot
      - Enable Full Screen Logo Display
      - Disable GO2BIOS
      - Bootup NumLock State:  `On`
      - Info Block effect:  `Unlock`
      - Disable POST Beep
      - Disable MSI Fast Boot
      - Disable Fast Boot
    - Security
      - Disable U-Key
      - Trusted Computing
        - Disable Security Device Support
        - TPM Device Selection:  `fTPM 2.0`
        - Disable Disable Block Sid
      - Chassis Intrusion Configuration
        - Disable Chassis Intrusion
      - Secure Boot
        - Disable Secure Boot
        - Secure Boot Mode:  `Standard`
  - OC
    - CPU Features
      - Enable Virtualization
      - Disable CFG-Lock
      - Disable VT-d
      - Disable SGX

## USB Port Mapping

Info used for USBToolBox

[usb.json](usb.json)

2025-04-01 - Re-did USB map with `corpnewt/USBMap` to enable the
Internal JUSB1 and JUSB2 connectors for the Wifi card.  This tool
creates and uses a plist file it creates: `Scripts/USB.plist`
([USB.plist](USB.plist))

In the new mapping, in the back ports, the ports under the 2.5G NIC
and the port above the USB-C port are USB 3.0 only.  The two ports
under the 1.0G NIC are USB 2.0 only.

**ASMedia USB 3.2 eXtensible Host Controller**
| Selected | Port # | Description | Type | Protocol | Companion | Name |
| --- | --- | --- | --- | --- | --- | --- |
| Yes | 01 | Back | USB-C | USB 3.0 | 02 | `BACK-USBC-3.0` |
| Yes | 02 | Back | USB-C | USB 2.0 | 01 | `BACK-USBC-2.0` |

**Intel USB 3.1 eXtensible Host Controller**
| Selected | Port # | Description | Type | Protocol | Companion | Name |
| --- | --- | --- | --- | --- | --- | --- |
| | 01 | Back USB A above USB-C | USB A | USB 2.0 | 17 | `BACK-USBA-ABOVE-USBC-2.0` |
| | 02 | Unknown | | USB 2.0 | | |
| Yes | 03 | Left Front Panel | USB A | USB 2.0 | 19 | `FRONT-USBA-LEFT-2.0` |
| Yes | 04 | Right Front Panel | USB A | USB 2.0 | 20 | `FRONT-USBA-RIGHT-2.0` |
| Yes | 05 | Back USB A below Intel I219-V NIC | USB A | USB 2.0 | 21 | `BACK-USBA-1BELOW-I219V-2.0` |
| Yes | 06 | Back USB A below Intel I219-V NIC and port 05/21 | USB A | USB 2.0 | 22 | `BACK-USBA-2BELOW-I219V-2.0` |
| Yes | 07 | Back Keyboard/Mouse - Bottom | USB A | USB 2.0 |  | `BACK-USBA-TOP-KEY-2.0` |
| Yes | 08 | Back Keyboard/Mouse - Top | USB A | USB 2.0 | | `BACK-USBA-BOT-KEY-2.0` |
| | 09 | Back USB A below Realtek 2.5G NIC and port 10/26 | USB A | USB 2.0 | 25 | `BACK-USBA-2BELOW-RT2.5G-2.0` |
| | 10 | Back USB A below Realtek 2.5G NIC | USB A | USB 2.0 | 26 | `BACK-USBA-1BELOW-RT2.5G-2.0` |
| Yes | 11 | USB 2.0 Hub - Internal connectors `JUSB1` and `JUSB2` both connect on this port. | | USB 2.0 | | `INT-2.0` |
| Yes | 12 | Mystic Light (internal? ARGB?) | | USB 2.0 | | `INT-MYSTICLIGHT-2.0` |
| Yes | 13 | Front Panel | USB-C | USB 2.0 | 18 | `FRONT-USBC-2.0` |
| | 14 | Unknown | | USB 2.0 | | |
| | 15 | Unknown | | USB 2.0 | | |
| | 16 | Unknown | | USB 2.0 | | |
| Yes | 17 | Back USB A above USB-C | USB A | USB 3.0 | 01 | `BACK-USBA-ABOVE-USBC-3.0` |
| Yes | 18 | Front Panel | USB-C | USB 3.0 | 13 | `FRONT-USBC-3.0` |
| Yes | 19 | Left Front Panel USB A | USB A | USB 3.0 | 03 | `FRONT-USBA-LEFT-3.0` |
| Yes | 20 | Right Front Panel USB A | USB A | USB 3.0 | 04 | `FRONT-USBA-RIGHT-3.0` |
| | 21 | Back USB A below Intel I219-V NIC | USB A | USB 3.0 | 05 | `BACK-USBA-1BELOW-I219V-3.0` |
| | 22 | Back USB A below Intel I219-V NIC and port 21 | USB A | USB 3.0 | 06 | `BACK-USBA-2BELOW-I219V-3.0` |
| | 23 | Unknown | | USB 3.0 | | |
| | 24 | Unknown | | USB 3.0 | | |
| Yes | 25 | Back USB A below Realtek 2.5G NIC and port 26 | USB A | USB 3.0 | 09 | `BACK-USBA-2BELOW-RT2.5G-3.0` |
| Yes | 26 | Back USB A below Realtek 2.5G NIC | USB A | USB 3.0 | 10 | `BACK-USBA-1BELOW-RT2.5G-3.0` |

### Back panel ports
![Rear Ports](USBToolBox_Port_Map.png)
